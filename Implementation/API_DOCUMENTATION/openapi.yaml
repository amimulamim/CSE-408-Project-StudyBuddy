openapi: 3.0.3
info:
  title: StudyBuddy API
  version: 1.0.0
  description: API docs for StudyBuddy modules
servers:
- url: http://localhost:8000
tags:
- name: Auth
- name: Chat
- name: Billing
  description: Subscription and payment management
- name: Quiz
  description: Quiz management and operations,Question retrieval , submission and
    evaluation
- name: ResourceProcessing
  description: Document processing ,parsing and vectorization
- name: Content
  description: Content generation and management, including slides, flashcards,pdf
paths:
  /api/auth/signup:
    post:
      tags:
      - Auth
      summary: Sign up using email and password
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
              - email
              - password
              properties:
                email:
                  type: string
                  format: email
                password:
                  type: string
                  format: password
      responses:
        '201':
          description: User created
        '400':
          description: Invalid input
  /api/auth/login:
    post:
      tags:
      - Auth
      summary: Log in using email and password
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
              - email
              - password
              properties:
                email:
                  type: string
                  format: email
                password:
                  type: string
                  format: password
      responses:
        '200':
          description: Login successful
        '401':
          description: Unauthorized
  /api/auth/google:
    post:
      tags:
      - Auth
      summary: Google Sign-in
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
              - idToken
              properties:
                idToken:
                  type: string
      responses:
        '200':
          description: Google login/signup handled
        '401':
          description: Invalid token
  /api/auth/user-info:
    get:
      tags:
      - Auth
      summary: Get user info
      security:
      - bearerAuth: []
      responses:
        '200':
          description: User profile
        '401':
          description: Unauthorized
  /billing/subscribe:
    post:
      tags:
      - Billing
      summary: Create a checkout session to subscribe to premium plan
      description: 'Redirects the user to the payment provider (e.g., Stripe) to complete
        the checkout.

        '
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                planId:
                  type: string
                  example: premium_monthly
                successUrl:
                  type: string
                cancelUrl:
                  type: string
      responses:
        '200':
          description: Checkout session created
          content:
            application/json:
              schema:
                type: object
                properties:
                  checkoutUrl:
                    type: string
                    description: Redirect URL to complete payment
        '400':
          description: Invalid request
  /billing/status:
    get:
      tags:
      - Billing
      summary: Check the user's current subscription status
      security:
      - bearerAuth: []
      responses:
        '200':
          description: Subscription status details
          content:
            application/json:
              schema:
                type: object
                properties:
                  plan:
                    type: string
                    enum:
                    - free
                    - premium
                  active:
                    type: boolean
                  expiresAt:
                    type: string
                    format: date-time
  /billing/cancel:
    post:
      tags:
      - Billing
      summary: Cancel the current user's subscription
      security:
      - bearerAuth: []
      responses:
        '200':
          description: Subscription cancellation confirmed
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
  /billing/webhook:
    post:
      tags:
      - Billing
      summary: Handle incoming payment gateway webhooks
      description: 'Receives events from payment providers like Stripe. This endpoint
        is **internal** and should be secured with a secret key.

        '
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              additionalProperties: true
      responses:
        '200':
          description: Webhook processed
  /ai/chat:
    post:
      tags:
      - Chat
      summary: Start or continue a chat with AI
      description: 'Starts a new chat session if `chatId` is not provided.

        If `chatId` is provided, the message is added to the existing session.

        '
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required: []
              properties:
                text:
                  type: string
                  description: User's message text
                image:
                  type: string
                  format: binary
                  description: Optional image file
                chatId:
                  type: string
                  description: Optional chat session ID
      responses:
        '200':
          description: AI responded successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  chatId:
                    type: string
                  messages:
                    type: array
                    items:
                      $ref: '#/components/schemas/Message'
        '400':
          description: Invalid input (e.g., no message, multiple files, file too large)
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
        '401':
          description: Unauthorized (missing or invalid token)
        '413':
          description: Payload too large (file size exceeded)
  /ai/chat/list:
    get:
      tags:
      - Chat
      summary: Get list of all chat sessions for the user
      security:
      - bearerAuth: []
      responses:
        '200':
          description: List of chat sessions
          content:
            application/json:
              schema:
                type: object
                properties:
                  chats:
                    type: array
                    items:
                      type: object
                      properties:
                        _id:
                          type: string
                        name:
                          type: string
        '401':
          description: Unauthorized
  /ai/chat/{chatId}:
    get:
      tags:
      - Chat
      summary: Retrieve a specific chat session by ID
      security:
      - bearerAuth: []
      parameters:
      - in: path
        name: chatId
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Chat session details
          content:
            application/json:
              schema:
                type: object
                properties:
                  _id:
                    type: string
                  name:
                    type: string
                  messages:
                    type: array
                    items:
                      $ref: '#/components/schemas/Message'
        '401':
          description: Unauthorized
        '404':
          description: Chat not found
    delete:
      tags:
      - Chat
      summary: Delete a specific chat session
      security:
      - bearerAuth: []
      parameters:
      - in: path
        name: chatId
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Chat session deleted
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  chatId:
                    type: string
        '401':
          description: Unauthorized
        '404':
          description: Chat not found
  /ai/chat/{chatId}/rename:
    patch:
      tags:
      - Chat
      summary: Rename an existing chat session
      security:
      - bearerAuth: []
      parameters:
      - in: path
        name: chatId
        required: true
        schema:
          type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
              - name
              properties:
                name:
                  type: string
                  description: New chat name
      responses:
        '200':
          description: Chat renamed successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  _id:
                    type: string
                  name:
                    type: string
        '400':
          description: Invalid request (e.g., empty name)
        '401':
          description: Unauthorized
        '404':
          description: Chat not found
  /api/content/generate:
    post:
      tags:
      - Content
      summary: Request AI-generated educational content
      description: 'User submits a content request by specifying content type, topic,
        and optional parameters.

        The backend uses RAG (retrieval-augmented generation) to generate and store
        personalized educational content.

        '
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
              - contentType
              - contentTopic
              properties:
                contentType:
                  type: string
                  enum:
                  - slides
                  - flashcards
                  - summary
                  - quiz
                  example: slides
                contentTopic:
                  type: string
                  example: Photosynthesis
                difficulty:
                  type: string
                  enum:
                  - easy
                  - medium
                  - hard
                  example: medium
                length:
                  type: string
                  enum:
                  - short
                  - medium
                  - long
                  example: medium
                tone:
                  type: string
                  enum:
                  - formal
                  - friendly
                  - instructive
                  example: instructive
      responses:
        '200':
          description: Content generated and stored successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  contentId:
                    type: string
                  content:
                    type: string
                  metadata:
                    type: object
                    properties:
                      type:
                        type: string
                      topic:
                        type: string
                      createdAt:
                        type: string
                        format: date-time
        '400':
          description: Invalid input parameters
        '403':
          description: User not authorized to generate content
        '500':
          description: Internal server error
  /api/content/{contentId}:
    get:
      tags:
      - Content
      summary: Retrieve previously generated content by ID
      parameters:
      - in: path
        name: contentId
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Content fetched
          content:
            application/json:
              schema:
                type: object
                properties:
                  contentId:
                    type: string
                  content:
                    type: string
                  metadata:
                    type: object
        '404':
          description: Content not found or access denied
  /api/content/user:
    get:
      tags:
      - Content
      summary: Get all previously generated contents by user
      security:
      - bearerAuth: []
      responses:
        '200':
          description: List of user-generated contents
          content:
            application/json:
              schema:
                type: object
                properties:
                  contents:
                    type: array
                    items:
                      type: object
                      properties:
                        contentId:
                          type: string
                        topic:
                          type: string
                        type:
                          type: string
                        createdAt:
                          type: string
                          format: date-time
        '401':
          description: Unauthorized
  /api/content/raw/{contentId}:
    get:
      tags:
      - Content
      summary: View raw content by ID
      parameters:
      - in: path
        name: contentId
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Raw content details
          content:
            application/json:
              schema:
                type: object
                properties:
                  contentId:
                    type: string
                  rawText:
                    type: string
                    description: The raw unprocessed content generated by the backend
                  metadata:
                    type: object
                    properties:
                      topic:
                        type: string
                      contentType:
                        type: string
                      createdAt:
                        type: string
                        format: date-time
        '404':
          description: Content not found
  /api/content/raw/user:
    get:
      tags:
      - Content
      summary: View all raw contents by user
      security:
      - bearerAuth: []
      responses:
        '200':
          description: List of all raw contents generated by the user
          content:
            application/json:
              schema:
                type: object
                properties:
                  contents:
                    type: array
                    items:
                      type: object
                      properties:
                        contentId:
                          type: string
                        topic:
                          type: string
                        contentType:
                          type: string
                        createdAt:
                          type: string
                          format: date-time
        '401':
          description: Unauthorized
  /api/quiz/request:
    post:
      tags:
      - Quiz
      summary: Request a customized quiz
      description: Request a quiz with subject, topic, marks, time, and difficulty.
        Missing values default to recommended.
      security:
      - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
              - subject
              - topic
              - marks
              - time
              properties:
                subject:
                  type: string
                topic:
                  type: string
                marks:
                  type: integer
                time:
                  type: integer
                  description: Total duration (minutes)
                difficulty:
                  type: string
                  enum:
                  - Easy
                  - Medium
                  - Hard
      responses:
        '200':
          description: Quiz request accepted
          content:
            application/json:
              schema:
                type: object
                properties:
                  quizId:
                    type: string
                  status:
                    type: string
                    example: Submitted
        '400':
          description: Invalid or incomplete parameters
        '401':
          description: Unauthorized
  /api/quiz/{quizId}:
    get:
      tags:
      - Quiz
      summary: Fetch quiz questions
      description: Retrieve generated questions for the requested quiz session
      security:
      - bearerAuth: []
      parameters:
      - in: path
        name: quizId
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Quiz fetched
          content:
            application/json:
              schema:
                type: object
                properties:
                  quizId:
                    type: string
                  subject:
                    type: string
                  topic:
                    type: string
                  questions:
                    type: array
                    items:
                      $ref: '#/components/schemas/QuizQuestion'
        '404':
          description: Quiz not found
        '401':
          description: Unauthorized
  /api/quiz/{quizId}/submit:
    post:
      tags:
      - Quiz
      summary: Submit quiz answers
      description: Student submits answers before or at timeout.
      security:
      - bearerAuth: []
      parameters:
      - in: path
        name: quizId
        required: true
        schema:
          type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
              - answers
              properties:
                answers:
                  type: array
                  items:
                    type: object
                    properties:
                      questionId:
                        type: string
                      selectedOptions:
                        type: array
                        items:
                          type: string
      responses:
        '200':
          description: Submission successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: Submitted
        '400':
          description: Invalid answers
        '401':
          description: Unauthorized
        '404':
          description: Quiz not found
  /api/quiz/{quizId}/result:
    get:
      tags:
      - Quiz
      summary: Get quiz results and feedback
      description: View score, correct/incorrect answers, hints and dashboard analytics.
      security:
      - bearerAuth: []
      parameters:
      - in: path
        name: quizId
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Result summary returned
          content:
            application/json:
              schema:
                type: object
                properties:
                  score:
                    type: number
                  total:
                    type: number
                  correctAnswers:
                    type: array
                    items:
                      type: string
                  incorrectAnswers:
                    type: array
                    items:
                      type: string
                  explanations:
                    type: array
                    items:
                      type: object
                      properties:
                        questionId:
                          type: string
                        explanation:
                          type: string
                        hint:
                          type: string
                  analytics:
                    type: object
                    properties:
                      strengthTopics:
                        type: array
                        items:
                          type: string
                      weakTopics:
                        type: array
                        items:
                          type: string
                      timeTaken:
                        type: string
                        example: 17 minutes
        '401':
          description: Unauthorized
        '404':
          description: Result not found
  /resource/upload:
    post:
      tags:
      - ResourceProcessing
      summary: Upload a resource document (PDF)
      description: 'Uploads a PDF document. System automatically parses text, images,
        tables,

        chunks the text, vectorizes the content, and stores embeddings internally.

        '
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                file:
                  type: string
                  format: binary
                  description: PDF document file to upload
      responses:
        '200':
          description: Upload and processing completed successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  documentId:
                    type: string
                  processingStatus:
                    type: string
                    example: Completed
                  summary:
                    type: object
                    properties:
                      textExtracted:
                        type: boolean
                      imagesExtracted:
                        type: boolean
                      tablesExtracted:
                        type: boolean
        '400':
          description: Upload failed
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
components:
  schemas:
    Message:
      type: object
      properties:
        role:
          type: string
        text:
          type: string
        files:
          type: array
          items:
            type: string
        status:
          type: string
        timestamp:
          type: string
          format: date-time
    SubscriptionStatus:
      type: object
      properties:
        plan:
          type: string
          enum:
          - free
          - premium
        active:
          type: boolean
        expiresAt:
          type: string
          format: date-time
    ResourceProcessingSummary:
      type: object
      properties:
        textExtracted:
          type: boolean
        imagesExtracted:
          type: boolean
        tablesExtracted:
          type: boolean
    QuizQuestion:
      type: object
      required:
      - questionId
      - questionText
      - options
      properties:
        questionId:
          type: string
        questionText:
          type: string
        options:
          type: array
          items:
            type: string
        type:
          type: string
          enum:
          - Theoretical
          - ProblemSolving
        difficulty:
          type: string
          enum:
          - Easy
          - Medium
          - Hard
        marks:
          type: integer
        hints:
          type: array
          items:
            type: string
        explanation:
          type: string
    ContentItem:
      type: object
      properties:
        contentId:
          type: string
        content:
          type: string
        metadata:
          type: object
          properties:
            topic:
              type: string
            contentType:
              type: string
            createdAt:
              type: string
              format: date-time
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
